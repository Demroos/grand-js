!function(a,b,c){var d=a(c),e={modules:{},waitModules:{},objects:{},init_modules:[],modules_count:0,getCookie:function(a){var b=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return b?decodeURIComponent(b[1]):void 0},setCookie:function(a,b,c,d){var e={};e.root=c||"/",e.time=d||6e4;new Date((new Date).getTime()+e.time);document.cookie=a+"="+b+"; path="+e.root+"; expires=180"},delCookie:function(a){var b=new Date(0);document.cookie=a+"=; path=/; expires="+b.toUTCString()},getObject:function(a){if(!a)return!1;"undefined"==typeof e.objects[a]&&(e.objects[a]=new e.base_objects(a));var b=e.objects[a];return b},inherit:function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=this,a.superClass=b},inheritExt:function(a,b){var c=function(){b.apply(this,arguments)};c.prototype=Object.create(b.prototype);for(var d in a)a.hasOwnProperty(d)&&(c.prototype[d]=a[d]);return c},mixin:function(a,b){for(var c in b)a.prototype[c]=b[c]},extend:function(a,b){for(var c in b)a[c]=b[c]},getWeekDay:function(a){a=a||new Date;var b=["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],c=a.getDay();return b[c]},getMonthWord:function(a){a=a||new Date;var b=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря","февраля"],c=a.getMonth();return b[c]},addModule:function(a,b){return this.modules[a]=b,this.trigger("add_module",{name:a}),this},initModules:function(b){var c=b.find(".js"),d={};e.logger.info("Find "+c.length+" modules."),c.each(function(){var b=a(this),c=b.data("module"),e=b.data("config");if(void 0!==c){var f={};f.$el=b,f.config=e,"undefined"!=typeof d[c]?d[c].push(f):(d[c]=[],d[c].push(f))}});for(var f in d)e.waitModule(d[f],f)},waitModule:function(a,b){if("undefined"!=typeof e.waitModules[b]){if(e.waitModules[b]>30)return e.logger.info("End time for wait "+b),!1;e.waitModules[b]++}else e.waitModules[b]=1;"undefined"!=typeof e.modules[b]?(a.forEach(function(a){var c=new e.modules[b](a.$el,a.config);c.init(),a.$el.data(b,c),"undefined"==typeof e.init_modules[b]&&(e.init_modules[b]=[]),e.init_modules[b].push(c),e.modules_count++}),e.logger.info("Initialization modules type <"+b+"> finished. Total "+e.modules_count)):e.on("add_module",function(c){c.name==b&&e.waitModule(a,b)})},getDomModules:function(b,c){var d=[];return a(".js",b).each(function(){var b=a(this).data(c);d.push(b)}),d},initComponents:function(b){b.find(".js").each(function(){var b=a(this),c=b.data("component");c&&b[c]()})},ajax:function(b,c){var d=b;return d.success=function(b){var d=a(b),f=a("<div></div>");f.html(d),e.initComponents(f),e.initModules(f);f.html();c&&c(d)},a.ajax(d)},createModule:function(a,b,c,d){var f=null;if(c.length>0)for(var g=0;g<c.length;g++)e.extend(d,e._mixins[c[g]]);"function"==typeof b?f=e.inheritExt(d,b):"string"==typeof b&&(f=e.inheritExt(d,e.modules[b])),null!=f&&e.addModule(a,f)},logger:{info:function(a){console.log(a)}}};a(c).ready(function(){e.initComponents(d),e.initModules(d)}),b.app=e}(jQuery,window,document),function(a,b,c){"use strict";function d(a,b){function d(a,b){h.data[a]=b}function e(a){h.data=a}function g(a,b){var d=a||f.success_cb,e=b||f.error_cb,g={data:{}};g.data[h.id]=h.data,$.ajax({url:"/manager/saveObject/"+h.id+".json",data:g,dataType:"json",type:"POST",success:function(a){"undefined"!=typeof a.save&&1==a.save?(c.notification.add("Сохранение успешно","success"),h.trigger("save",h.data)):(c.notification.add("Сохранение не успешно","error"),h.trigger("error.save",arguments)),d(a)},error:function(a,b){e()}})}this.id=a,this.data={},this.events={};var h=this;return this.addEvent=function(a,b){if("undefined"==typeof h.events&&(h.events={}),"undefined"!=typeof h.events[a]){var c=h.events[a];"undefined"==typeof c.funcs&&(c.funcs=[]),c.funcs.push(b)}else h.events[a]={funcs:[]},h.events[a].funcs.push(b)},this.trigger=function(a,b){"undefined"!=typeof h.events[a]?h.events[a].funcs.forEach(function(a){var c=b||{};a(c)}):c.logger.info("Event <"+a+"> not found")},{set:d,save:g,setData:e,addEvent:h.addEvent,trigger:h.trigger}}function e(a,b){this.events={}}var f={success_cb:function(){},error_cb:function(){}};c.base_objects=d,e.prototype.addEvent=function(a,b){if("undefined"==typeof this.events&&(this.events={}),"undefined"!=typeof this.events[a]){var c=this.events[a];"undefined"==typeof c.funcs&&(c.funcs=[]),c.funcs.push(b)}else this.events[a]={funcs:[]},this.events[a].funcs.push(b)},e.prototype.trigger=function(a,b){void 0!=this.events[a]&&this.events[a].funcs.forEach(function(a){var c=b||{};a(c)})},c.Base_module=e,c._mixins={},c._mixins.event={_eventHandlers:{},on:function(a,b){this._eventHandlers[a]||(this._eventHandlers[a]=[]),this._eventHandlers[a].push(b)},off:function(a,b){var c=this._eventHandlers[a];if(c)for(var d=0;d<c.length;d++)c[d]==b&&c.splice(d--,1)},trigger:function(a){if(this._eventHandlers[a])for(var b=this._eventHandlers[a],c=0;c<b.length;c++)b[c].apply(this,[].slice.call(arguments,1))}};var g=function(a,b,c){return a+"_"+b+"_"+c};c._mixins.bem={addMod:function(a,b){var c=g(this["class"],a,b);this.$el.addClass(c)},delMod:function(a,b){var c=g(this["class"],a,b);this.$el.removeClass(c)}}}(window,document,app),function(a,b,c){"use strict";c.extend(c,c._mixins.event),c.on("add_module",function(a){c.logger.info("Loaded module <"+a.name+">")})}(window,document,app),function(a,b){"use strict";function c(a){this.$el=a,this._construct(arguments),this._bindEvents()}var d=/\s+/,e=function(a,c,e,f){var g=c.split(d);if(2==g.length){var h=g[0],i=g[1];a.on(h,i,b.proxy(e[f],e))}};c.prototype={constructor:c,name:"Base module",initClass:"module_init",events:{},init:function(a){this.$el.addClass(this.initClass)},_construct:function(){},_bindEvents:function(){for(var a in this.events)e(this.$el,a,this,this.events[a])}},a.createModule("module.base",c,[],{})}(app,jQuery);